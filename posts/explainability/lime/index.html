<!DOCTYPE html>
<html>
  <head>
    <title>LIME</title>
    <meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta http-equiv="X-UA-Compatible" content="ie=edge" />


<link rel="stylesheet" href="../../../css/bootstrap.min.css"/>
<link rel="stylesheet" href="../../../css/layouts/main.css"/>
<link rel="stylesheet" href="../../../css/navigators/navbar.css"/>
<link rel="stylesheet" href="../../../css/plyr.css"/>
<link rel="stylesheet" href="../../../css/flag-icon.min.css"/>


<link href="https://fonts.googleapis.com/css2?family=Muli:wght@300;400;500;600" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" />




  

  
  
  
    
  
  

  <link rel="icon" type="image/png" href="../../../images/logo/logo7_hu3caad16149ca40ba63bd16515237a582_11068_42x0_resize_box_3.png" />
<meta property="og:title" content="LIME" />
<meta property="og:description" content="Sample post with multiple images, embedded video ect." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://naigamshah.github.io/posts/explainability/lime/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2021-09-16T06:00:20+06:00" />
<meta property="article:modified_time" content="2021-09-16T06:00:20+06:00" />


    
    
<meta name="description" content="Sample post with multiple images, embedded video ect." />
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/atom-one-dark.min.css"
/>
<link rel="stylesheet" href="../../../css/layouts/single.css"/>
<link rel="stylesheet" href="../../../css/navigators/sidebar.css">

<link rel="stylesheet" href="../../../css/style.css"/>



    
    
      
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-174931179-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

    
  </head>

  <body data-spy="scroll" data-target="#TableOfContents" data-offset="80">
    <div class="container-fluid bg-dimmed wrapper">
      
      
    





  


  




  
  
    
  
  



  
  
    
  
  


<nav class="navbar navbar-expand-xl top-navbar final-navbar shadow">
  <div class="container">
      <button class="navbar-toggler navbar-light" id="sidebar-toggler" type="button" onclick="toggleSidebar()">
      <span class="navbar-toggler-icon"></span>
    </button>
    <a class="navbar-brand" href="../../../">
      
        <img src="../../../images/logo/logo7_hu3caad16149ca40ba63bd16515237a582_11068_42x0_resize_box_3.png" alt="Logo">
      Naigam Shah</a>
    <button class="navbar-toggler navbar-light" id="toc-toggler" type="button" onclick="toggleTOC()">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse lang-selector" id="top-nav-items">
      <ul class="navbar-nav ml-auto">
      
      </ul>
    </div>
  </div>
  
  
    <img src="../../../images/logo/logo7_hu3caad16149ca40ba63bd16515237a582_11068_42x0_resize_box_3.png" class="d-none" id="main-logo" alt="Logo">
  
  
    <img src="../../../images/logo/logo7_hu3caad16149ca40ba63bd16515237a582_11068_42x0_resize_box_3.png" class="d-none" id="inverted-logo" alt="Inverted Logo">
  
</nav>



      
      
  <section class="sidebar-section" id="sidebar-section">
    <div class="sidebar-holder">
      <div class="sidebar" id="sidebar">
        <form class="mx-auto" method="get" action="../../../search">
          <input type="text" name="keyword" value="" placeholder="Search" data-search="" id="search-box" />
        </form>
        <div class="sidebar-tree">
          <ul class="tree" id="tree">
            <li id="list-heading"><a href="../../../posts" data-filter="all">Posts</a></li>
            <div class="subtree">
                
  
  
  
  
    
    
  
  
    
    <li>
      <i class="fas fa-minus-circle"></i><a class="active" href="../../../posts/explainability/">Explainability</a>
      
      <ul class="active">
        
  
  
  
  
  
    
    <li><a class="" href="../../../posts/explainability/introduction/" title="Introduction">Introduction</a></li>
  

  
  
  
  
    
    
  
  
    
    <li><a class="active" href="../../../posts/explainability/lime/" title="LIME">LIME</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="../../../posts/explainability/exbert/" title="exBERT">exBERT</a></li>
  

  
  
  
  
  
    
    <li><a class="" href="../../../posts/explainability/shap/" title="SHAP">SHAP</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li>
      <i class="fas fa-plus-circle"></i><a class="" href="../../../posts/rl/">Reinforcement Learning</a>
      
      <ul class="">
        
  
  
  
  
  
    
    <li><a class="" href="../../../posts/rl/introduction/" title="Introduction">Introduction</a></li>
  


      </ul>
    </li>
  

  
  
  
  
  
    
    <li><a class="" href="../../../posts/projects/" title="Project Overviews">Project Overviews</a></li>
  


            </div>
          </ul>
        </div>
      </div>
    </div>
  </section>


      
      
<section class="content-section" id="content-section">
  <div class="content">
    <div class="container p-0 read-area">
      
      <div class="hero-area col-sm-12" id="hero-area" style='background-image: url(https://naigamshah.github.io/images/posts/writing-posts/lime.jpg);'>
      </div>

      
      <div class="page-content">
        <div class="author-profile ml-auto align-self-lg-center">
          
        </div>

        <div class="pt-5 title">
          <p></p>
          <h1><b>LIME</b></h1>
          <p style="font-family:'Courier New'; font-size:14px">Last Modified: 16 Sep,&#39;21</p>
        </div>

        <div class="post-content" id="post-content">
          <p>LIME is a local interpretability technique that uses a simpler surrogate model like linear regression or decision tree, to explain the original complex <em>t</em>arget model**. It is a <strong>model agnostic</strong> method, meaning it does not depend on the underlying nature of the target model, and that makes this technique very flexible to accommodate any kind of machine/deep learning architectures. The way LIME works is:</p>
<img src="../../../posts/explainability/images/lime_intro.jpg"
    
        alt="Figure 1."
    
    
    
    
    
        class="center"
    
>

<!-- raw HTML omitted -->
<ol>
<li>The algorithm takes in the local instance which you want to get explanations for.</li>
<li>New local dataset is formed of user specified size:
<ul>
<li>Random features are sampled from the instance as set <em>S</em>.</li>
<li>The selected features in set <em>S</em> are then perturbed. By default, for numeric features the feature values are tweaked whereas for textual data the features/tokens are masked from the instance.</li>
<li>These steps are repeated until user specified size of the dataset is achieved.</li>
</ul>
</li>
<li>Instances in new formed dataset are weighted according to their distance with the original instance.</li>
<li>This new dataset is passed through the original model to get its prediction labels.</li>
<li>Using the new dataset and labels of original model, train the simpler surrogate model.</li>
<li>Give out final explanations by interpreting the surrogate model.</li>
</ol>
<hr>
<h3 id="1-lime-for-text">1. LIME for Text</h3>
<p>LIME by itself is very naive for textual data, but nevertheless gives out decent level explanations that can help us understand the intricacies of the target model. As discussed earlier, the algorithm randomly masks words from the original text and then trains a surrogate model on top of that. Later the weights of the surrogate model are retrieved as explanations for the given text.</p>
<h5 id="example">Example:</h5>
<p>The dataset used for this example is <a href="https://www.kaggle.com/c/quora-insincere-questions-classification/data?select=train.csv">Quora Insincere Questions Classification</a>. An insincere question is defined as a question intended to make a statement rather than one looking for helpful answers.</p>
<!-- raw HTML omitted -->
<img src="../../../posts/explainability/images/lime_example.jpg"
    
        alt="Figure 2."
    
    
    
    
    
        class="center"
    
>

<!-- raw HTML omitted -->
<p>The above image depicts a generic output of LIME on textual data, wherein each orange bar denotes the tokens that contributed towards <em>insincere</em> class and their importance, and on the other hand each blue bar denotes the tokens that contributed towards other classes (in this case <em>sincere</em> class) and their importance.</p>
<hr>
<h3 id="2-pros-of-using-lime-on-text">2. Pros of using LIME on Text</h3>
<ol>
<li>LIME is model agnostic making it flexible to include heavy-weight models like Bert, GPT, etc which are also state-of-the-art models in NLP.</li>
<li>By default, LIME returns R<!-- raw HTML omitted -->2<!-- raw HTML omitted --> Score as a fidelity metric, which indicates how well has the surrogate model approximated the target model.</li>
<li>In my experience, LIME&rsquo;s results were reflective of the model&rsquo;s performance.</li>
</ol>
<hr>
<h3 id="3-cons-of-using-lime-on-text">3. Cons of using LIME on Text</h3>
<ol>
<li>LIME being a local explainability method cannot summarize results at a global level.</li>
<li>It takes ample of time to get all the explanations form a large dataset using LIME. But after all it&rsquo;s a downside which normally all local explainability techniques suffer with.</li>
<li>Only using R<!-- raw HTML omitted -->2<!-- raw HTML omitted --> Score to judge how well the explanations are returned from LIME is not sufficient.</li>
<li>By default, the sampling used to mask tokens is Random Sampling. It in turn ignores one of the most important concepts of text based learning, the context present in the text.</li>
<li>By default, the distance metric is set as cosine similarity, which uses tf-idf at its core. Weighing texts only in terms of frequency is not sufficient and will not give the correct picture.</li>
<li>LIME suffers from instability i.e., its results can vary largely for minor perturbations.</li>
<li>LIME uses masking of tokens to form the neighborhood of a text, which is not the most ideal way.</li>
<li>The set of hyper-parameters is also local i.e., an optimal hyper-parametric set for one text may not be optimal for the other.</li>
</ol>
<hr>
<p><strong>Updates:</strong>
<em>No updates as of now</em></p>
<hr>

        </div>

        
        

        
      <hr />
        









  
  

  
    
    
  
  

  
  

  
  

  
  

  
  


<div class="row next-prev-navigator">
  
    <div class="col-md-6 previous-article">
      <a href="../../../posts/explainability/introduction/" title="Explaining Explainability" class="btn btn-outline-info">
        <div><i class="fas fa-chevron-circle-left"></i> Prev</div>
        <div class="next-prev-text">Explaining Explainability</div>
      </a>
    </div>
  
  
      
      
        
      
      <div class="col-md-6 next-article">
        <a href="../../../posts/explainability/exbert/" title="exBERT" class="btn btn-outline-info">
          <div>Next <i class="fas fa-chevron-circle-right"></i></div>
          <div class="next-prev-text">exBERT</div>
        </a>
      </div>
    
</div>

      <hr />
      
      
      </div>
    </div>
  </div>
  
  <a id="scroll-to-top" class="btn"><i class="fas fa-chevron-circle-up"></i></a>
  
</section>


      
      
  <section class="toc-section" id="toc-section">
    
    <div class="toc-holder">
      <h5 class="text-center pl-3">Table of Contents</h5>
      <hr>
      <div class="toc">
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#1-lime-for-text">1. LIME for Text</a>
          <ul>
            <li>
              <ul>
                <li><a href="#example">Example:</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#2-pros-of-using-lime-on-text">2. Pros of using LIME on Text</a></li>
        <li><a href="#3-cons-of-using-lime-on-text">3. Cons of using LIME on Text</a></li>
      </ul>
    </li>
  </ul>
</nav>
      </div>
    </div>
    
  </section>

    </div>

    
    









  
      
  



  
  
    
  

  
  
    
  

  
  
    
    
  


  
  
  

  
  
  

  
  
  
    
  
  

  
  
  

  <footer class="container-fluid text-center align-content-center footer pb-2">
    <div class="text-center">
      <span style="color: #FFFFFF;font-size:40px;">&#10524;</span>
      <span style="color: #FFFFFF;font-size:40px;">&#10523;</span>
    </div>
    <div class="container pt-5">
      <div class="row text-left">
        
        <div class="col-md-4 col-sm-12">
          <h5>Navigation</h5>
          
          <ul>
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="../../../#about">About Me</a>
                </li>
              
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="../../../#recent-posts">Recent Posts</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="../../../#experiences">Experiences</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="../../../#education">Education</a>
                </li>
              
              
                
                
                  
                
                <li class="nav-item">
                  <a class="smooth-scroll" href="../../../#projects">Projects</a>
                </li>
              
              
              
              
              
              
          </ul>
          
        </div>
        
        
        <div class="col-md-4 col-sm-12">
          <h5>Contact me:</h5>
          <ul>
            
            <li><span>Email: </span> <span>n7shah@ucsd.edu</span></li>
            
          </ul>
        </div>
        
        
        
      </div>
    </div>
    
    
    <hr />
    <div class="container">
      <div class="row text-center">
        
        <div class="col-md-12 text-center">© 2021 Copyright.</div>
        
      </div>
    </div>
    
    
  </footer>


    <script type="text/javascript" src="../../../js/jquery-3.4.1.min.js"></script>
<script type="text/javascript" src="../../../js/popper.min.js"></script>
<script type="text/javascript" src="../../../js/bootstrap.min.js"></script>

<script type="text/javascript" src="../../../js/navbar.js"></script>
<script type="text/javascript" src="../../../js/plyr.js"></script>
<script type="text/javascript" src="../../../js/main.js"></script>


    
    
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js"></script>
<script src="../../../js/single.js"></script>
<script>
  hljs.initHighlightingOnLoad();
</script>


  </body>
</html>
